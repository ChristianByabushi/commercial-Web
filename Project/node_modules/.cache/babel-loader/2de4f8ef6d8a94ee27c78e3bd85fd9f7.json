{"ast":null,"code":"import axios from 'axios';\nimport html2pdf from \"html2pdf.js\";\nexport default {\n  name: \"analysis\",\n  data: () => ({\n    header_invoices: [{\n      text: 'Facture Idop',\n      value: 'id_line'\n    }, {\n      text: 'Date de Vente',\n      value: 'created_at'\n    }, {\n      text: 'Item',\n      value: 'title'\n    }, {\n      text: 'PUA',\n      value: 'pu_by'\n    }, {\n      text: 'PUV',\n      value: 'pu_sale'\n    }, {\n      text: 'Qte Vendue',\n      value: 'amount_sale'\n    }, {\n      text: 'Prix Achat Total',\n      value: 'price_by'\n    }, {\n      text: 'Prix Vente Total',\n      value: 'price_sale'\n    }, {\n      text: 'Résultat',\n      value: 'result'\n    }],\n    list_invoices: [],\n    created_at: new Date().toJSON().slice(0, 10).replace(/-/g, '-'),\n    itemSelected: '',\n    merchandises: [],\n    resultatInvoices: [],\n    printDisplay: false\n  }),\n  methods: {\n    async printEtatInvoices() {\n      html2pdf(document.getElementById(\".element-print-invoices\"), {\n        margin: 2,\n        filename: \"Rapport stock du\" + this.created_at,\n        jsPDF: {\n          format: 'a4',\n          orientation: 'portrait'\n        }\n      });\n      this.printDisplay = false;\n    },\n\n    async getAllInvoices() {\n      try {\n        const formData = new FormData();\n        formData.append(\"created_at\", this.created_at);\n        formData.append(\"itemSelected\", this.itemSelected);\n        const response = await axios.post('lineInvoice/getResultInvoices', formData);\n        this.list_invoices = response.data[0];\n        this.resultatInvoices = response.data[1];\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async get_stock_merchandise() {\n      try {\n        const response = await axios.post('merchandise');\n        this.merchandises = response.data;\n      } catch (e) {\n        alert(e);\n      }\n    },\n\n    actualiser() {\n      this.created_at = new Date().toJSON().slice(0, 10).replace(/-/g, '-');\n      this.itemSelected = '';\n      this.resultatInvoices;\n      this.getAllInvoices();\n    }\n\n  },\n\n  created() {\n    this.getAllInvoices();\n    this.get_stock_merchandise();\n  }\n\n};","map":{"version":3,"mappings":"AAqFA;AACA;AACA;EACAA,gBADA;EAEAC;IACAC,kBACA;MAAAC;MAAAC;IAAA,CADA,EAEA;MAAAD;MAAAC;IAAA,CAFA,EAGA;MAAAD;MAAAC;IAAA,CAHA,EAIA;MAAAD;MAAAC;IAAA,CAJA,EAKA;MAAAD;MAAAC;IAAA,CALA,EAMA;MAAAD;MAAAC;IAAA,CANA,EAOA;MAAAD;MAAAC;IAAA,CAPA,EAQA;MAAAD;MAAAC;IAAA,CARA,EASA;MAAAD;MAAAC;IAAA,CATA,CADA;IAYAC,iBAZA;IAaAC,+DAbA;IAcAC,gBAdA;IAeAC,gBAfA;IAgBAC,oBAhBA;IAiBAC;EAjBA,EAFA;EAqBAC;IACA;MACAC;QACAC,SADA;QAEAC,8CAFA;QAGAC;UACAC,YADA;UAEAC;QAFA;MAHA;MAQA;IACA,CAXA;;IAYA;MACA;QACA;QACAC;QACAA;QACA;QACA;QACA;MACA,CAPA,CAOA;QACAC;MACA;IACA,CAvBA;;IAwBA;MACA;QACA;QACA;MACA,CAHA,CAGA;QACAC;MACA;IACA,CA/BA;;IAgCAC;MACA;MACA;MACA;MACA;IACA;;EArCA,CArBA;;EA4DAC;IACA;IACA;EACA;;AA/DA","names":["name","data","header_invoices","text","value","list_invoices","created_at","itemSelected","merchandises","resultatInvoices","printDisplay","methods","html2pdf","margin","filename","jsPDF","format","orientation","formData","console","alert","actualiser","created"],"sourceRoot":"src/views/analysis","sources":["analysis.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<v-subheader class=\"d-flex justify-space-between align-center\">\r\n\t\t\t<h3>Analyses</h3>\r\n\t\t</v-subheader>\r\n\r\n\t\t<v-alert dense type=\"info\" color=\"#757575\">\r\n\t\t\tCette partie contient les fonctionnalités sur l'analyse du déroulement des activités et des résulats sur les\r\n\t\t\tstocks et les vantes\r\n\t\t</v-alert>\r\n\t\t<v-card>\r\n\t\t\t<v-card-title style=\"display : inline\">\r\n\t\t\t\tMouvement des stocks des biens\r\n\t\t\t</v-card-title>\r\n\t\t\t<v-row class=\"ml-5\">\r\n\t\t\t\t<v-col cols=\"5\" sm=\"3\">\r\n\t\t\t\t\t<v-select :items=\"merchandises\" item-text=\"title\" @change=\"getAllInvoices()\" v-model=\"itemSelected\"\r\n\t\t\t\t\t\titem-value=\"id\" label=\"Item à considérer\">\r\n\t\t\t\t\t</v-select>\r\n\t\t\t\t</v-col>\r\n\t\t\t\t<v-col cols=\"6\" sm=\"4\">\r\n\t\t\t\t\t<v-text-field v-model=\"created_at\" type=\"date\" @change=\"getAllInvoices()\"\r\n\t\t\t\t\t\tlabel=\"Date à partir de laquelle commencer\">\r\n\t\t\t\t\t</v-text-field>\r\n\t\t\t\t</v-col>\r\n\t\t\t\t<v-col class=\"mt-3\" cols=\"6\" sm=\"4\" @click=\"actualiser\">\r\n\t\t\t\t\t<v-btn append-icon=\"\">\r\n\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\tmdi-refresh\r\n\t\t\t\t\t\t</v-icon>Actualiser\r\n\t\t\t\t\t</v-btn>\r\n\t\t\t\t</v-col>\r\n\t\t\t</v-row>\r\n\r\n\t\t\t<div class=\"element-print-invoices\">\r\n\t\t\t\t<v-card-title v-if=\"printDisplay = true\">\r\n\t\t\t\t\t<v-row>\r\n\t\t\t\t\t\t<v-col>\r\n\r\n\t\t\t\t\t\t\t<div style=\"display: inline\">\r\n\t\t\t\t\t\t\t\t<h4>Sté HumanATM</h4>\r\n\t\t\t\t\t\t\t\t<h6 id=\"dateReport\">Date : {{ created_at }}</h6>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t<v-col>\r\n\t\t\t\t\t\t\t<div >\r\n\t\t\t\t\t\t\t\t<img class=\"imglogo\" src=\"@/assets/logosidebar.jpg\" alt=\"\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</v-col>\r\n\r\n\t\t\t\t\t</v-row>\r\n\t\t\t\t</v-card-title>\r\n\r\n\t\t\t\t<v-card-text>\r\n\t\t\t\t\t<v-data-table :headers=\"header_invoices\" :items=\"list_invoices\" :items-per-page=\"7\"\r\n\t\t\t\t\t\tclass=\"elevation-1\">\r\n\t\t\t\t\t</v-data-table>\r\n\r\n\t\t\t\t\t<v-card class=\"mt-4\">\r\n\t\t\t\t\t\t<v-card-text style=\" display: inline-block;\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h5 class=\"font-weight-bold\">Calcul du résultat</h5>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h6 class=\"font-weight-bold\">Prix total Achat : {{ resultatInvoices.price_by }} </h6>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h6 class=\"font-weight-bold\">Prix total Vente : {{ resultatInvoices.price_sale }} </h6>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h6 class=\"font-weight-bold\">Résultat : {{ resultatInvoices.result }}</h6>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t</v-card>\r\n\t\t\t\t</v-card-text>\r\n\t\t\t</div>\r\n\t\t</v-card>\r\n\t\t<v-btn class=\"mt-4\" color=\"error\" @click=\"printDisplay = true; printEtatInvoices()\">\r\n\t\t\t<v-icon>mdi-printer</v-icon> Imprimer\r\n\t\t</v-btn>\r\n\t</div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\nimport html2pdf from \"html2pdf.js\";\r\nexport default {\r\n\tname: \"analysis\",\r\n\tdata: () => ({\r\n\t\theader_invoices: [\r\n\t\t\t{ text: 'Facture Idop', value: 'id_line' },\r\n\t\t\t{ text: 'Date de Vente', value: 'created_at' },\r\n\t\t\t{ text: 'Item', value: 'title' },\r\n\t\t\t{ text: 'PUA', value: 'pu_by' },\r\n\t\t\t{ text: 'PUV', value: 'pu_sale' },\r\n\t\t\t{ text: 'Qte Vendue', value: 'amount_sale' },\r\n\t\t\t{ text: 'Prix Achat Total', value: 'price_by' },\r\n\t\t\t{ text: 'Prix Vente Total', value: 'price_sale' },\r\n\t\t\t{ text: 'Résultat', value: 'result' },\r\n\t\t],\r\n\t\tlist_invoices: [],\r\n\t\tcreated_at: new Date().toJSON().slice(0, 10).replace(/-/g, '-'),\r\n\t\titemSelected: '',\r\n\t\tmerchandises: [],\r\n\t\tresultatInvoices: [],\r\n\t\tprintDisplay: false\r\n\t}),\r\n\tmethods: {\r\n\t\tasync printEtatInvoices() {\r\n\t\t\thtml2pdf(document.getElementById(\".element-print-invoices\"), {\r\n\t\t\t\tmargin: 2,\r\n\t\t\t\tfilename: \"Rapport stock du\" + this.created_at,\r\n\t\t\t\tjsPDF: {\r\n\t\t\t\t\tformat: 'a4',\r\n\t\t\t\t\torientation: 'portrait'\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\tthis.printDisplay = false\r\n\t\t},\r\n\t\tasync getAllInvoices() {\r\n\t\t\ttry {\r\n\t\t\t\tconst formData = new FormData()\r\n\t\t\t\tformData.append(\"created_at\", this.created_at)\r\n\t\t\t\tformData.append(\"itemSelected\", this.itemSelected)\r\n\t\t\t\tconst response = await axios.post('lineInvoice/getResultInvoices', formData)\r\n\t\t\t\tthis.list_invoices = response.data[0]\r\n\t\t\t\tthis.resultatInvoices = response.data[1]\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync get_stock_merchandise() {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post('merchandise')\r\n\t\t\t\tthis.merchandises = response.data\r\n\t\t\t} catch (e) {\r\n\t\t\t\talert(e)\r\n\t\t\t}\r\n\t\t},\r\n\t\tactualiser() {\r\n\t\t\tthis.created_at = new Date().toJSON().slice(0, 10).replace(/-/g, '-')\r\n\t\t\tthis.itemSelected = ''\r\n\t\t\tthis.resultatInvoices\r\n\t\t\tthis.getAllInvoices()\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getAllInvoices()\r\n\t\tthis.get_stock_merchandise()\r\n\t}\r\n\r\n}\r\n</script> \r\n<style scoped>\r\n.imglogo {\r\n\topacity: 1; \r\n\twidth: 100px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}