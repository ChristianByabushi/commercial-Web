{"ast":null,"code":"import axios from 'axios';\nimport html2pdf from \"html2pdf.js\";\nexport default {\n  name: \"resultInvoice\",\n  components: {},\n  data: () => ({\n    listInvoices: [],\n    urlImage: \"../assets/atmlogo.jpg\",\n    listInlines: [],\n    printLinePermit: false,\n    printinline: [],\n    listInvoicesPrint: [],\n    inlineInfo: [],\n    header_lineinvoices: [{\n      text: 'idOp',\n      align: 'start',\n      sortable: true,\n      value: 'id_line'\n    }, {\n      text: 'Client',\n      value: 'client'\n    }, {\n      text: 'Date',\n      value: 'created_at'\n    }, {\n      text: 'Prix Total ',\n      value: 'totalprice'\n    }, {\n      text: 'Reduction Accordée',\n      value: 'decrease'\n    }, {\n      text: 'Net à payer',\n      value: 'net_total_price'\n    }, {\n      text: 'actions',\n      value: 'actions'\n    }]\n  }),\n  methods: {\n    computeTotalPriceTopay() {\n      var r = 0;\n      this.listInvoicesPrint.forEach(element => {\n        r += element.pt;\n      });\n      return r;\n    },\n\n    async printInvoiceInline(idlineinvoice) {\n      try {\n        const response = await axios.post('lineInvoice/getInvoiceInfo/' + idlineinvoice.id_line);\n        this.listInvoicesPrint = response.data;\n        this.printinlineinfo(idlineinvoice.id_line);\n        this.printLinePermit = !this.printLinePermit;\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async printinlineinfo(id_line) {\n      try {\n        const response = await axios.post('lineInvoice/getInlineInfo/' + id_line);\n        this.inlineInfo = response.data;\n        console.log(this.inlineInfo);\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async printMethode() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 5,\n        filename: \"facture -\" + this.inlineInfo.client + \"-\" + this.inlineInfo.created_at,\n        jsPDF: {\n          format: 'a6',\n          orientation: 'portrait'\n        }\n      });\n    },\n\n    async deleteInvoiceInline(idlineinvoice) {\n      if (confirm(\"Voulez-vous supprimer cette facture de l'operation \" + idlineinvoice.id_line + \" ?\")) {\n        try {\n          const response = await axios.post('lineInvoice/deleteInvoice/' + idlineinvoice.id_line);\n          this.listInvoices = response.data;\n          this.get_listInlines();\n        } catch (e) {\n          console.log(e);\n        }\n      }\n    },\n\n    async get_listInvoices() {\n      try {\n        const response = await axios.post('invoice/');\n        this.listInvoices = response.data;\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    async get_listInlines() {\n      try {\n        const response = await axios.post('lineInvoice/');\n        this.listInlines = response.data;\n      } catch (e) {\n        console.log(e);\n      }\n    }\n\n  },\n\n  created() {\n    this.get_listInvoices();\n    this.get_listInlines();\n  }\n\n};","map":{"version":3,"mappings":"AAiFA;AACA;AAEA;EACAA,qBADA;EAEAC,cAFA;EAKAC;IACAC,gBADA;IAEAC,iCAFA;IAGAC,eAHA;IAIAC,sBAJA;IAKAC,eALA;IAMAC,qBANA;IAOAC,cAPA;IAQAC,sBACA;MACAC,YADA;MAEAC,cAFA;MAGAC,cAHA;MAIAC;IAJA,CADA,EAOA;MAAAH;MAAAG;IAAA,CAPA,EAQA;MAAAH;MAAAG;IAAA,CARA,EASA;MAAAH;MAAAG;IAAA,CATA,EAUA;MAAAH;MAAAG;IAAA,CAVA,EAWA;MAAAH;MAAAG;IAAA,CAXA,EAYA;MAAAH;MAAAG;IAAA,CAZA;EARA,EALA;EA6BAC;IACAC;MACA;MACA;QACAC;MACA,CAFA;MAGA;IACA,CAPA;;IAQA;MACA;QACA;QACA;QACA;QACA;MACA,CALA,CAKA;QACAC;MACA;IACA,CAjBA;;IAkBA;MACA;QACA;QACA;QACAA;MACA,CAJA,CAIA;QACAA;MACA;IACA,CA1BA;;IA2BA;MAEAC;QACAC,SADA;QAEAC,iFAFA;QAGAC;UACAC,YADA;UAEAC;QAFA;MAHA;IAQA,CArCA;;IAsCA;MACA;QACA;UACA;UACA;UACA;QACA,CAJA,CAIA;UACAN;QACA;MACA;IAEA,CAjDA;;IAkDA;MACA;QACA;QACA;MACA,CAHA,CAGA;QACAA;MACA;IACA,CAzDA;;IA0DA;MACA;QACA;QACA;MACA,CAHA,CAGA;QACAA;MACA;IACA;;EAjEA,CA7BA;;EAgGAO;IACA;IACA;EACA;;AAnGA","names":["name","components","data","listInvoices","urlImage","listInlines","printLinePermit","printinline","listInvoicesPrint","inlineInfo","header_lineinvoices","text","align","sortable","value","methods","computeTotalPriceTopay","r","console","html2pdf","margin","filename","jsPDF","format","orientation","created"],"sourceRoot":"src/views/invoices","sources":["resultInvoice.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<v-subheader class=\"d-flex justify-space-between align-center\">\r\n\t\t\t<h3>Résultats</h3>\r\n\t\t</v-subheader>\r\n\r\n\t\t<v-card>\r\n\t\t\t<v-card-title class=\"d-flex-inline\">\r\n\t\t\t\t<v-row>\r\n\t\t\t\t\t<h6>All</h6>\r\n\t\t\t\t</v-row>\r\n\t\t\t</v-card-title>\r\n\t\t\t<v-card-text>\r\n\t\t\t\t<v-data-table :headers=\"header_lineinvoices\" :items=\"listInlines\" :items-per-page=\"5\"\r\n\t\t\t\t\tclass=\"elevation-1\">\r\n\t\t\t\t\t<template v-slot:item.actions=\"{ item }\" class=\"d-flex justify-space-between align-center\">\r\n\t\t\t\t\t\t<v-icon small color=\"purple\" @click=\"printInvoiceInline(item)\">\r\n\t\t\t\t\t\t\tmdi-printer\r\n\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t<v-icon small class=\"mr-2\" @click.stop=\"deleteInvoiceInline(item)\" color=\"red\">\r\n\t\t\t\t\t\t\tmdi-delete\r\n\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</v-data-table>\r\n\t\t\t</v-card-text>\r\n\t\t</v-card>\r\n\t\t<v-card v-if=\"printLinePermit\" class=\"mt-10\">\r\n\t\t\t<div id=\"element-to-convert\">\r\n\t\t\t\t<v-card-title>\r\n\t\t\t\t\t<v-row>\r\n\t\t\t\t\t\t<v-col>\r\n\t\t\t\t\t\t\t<div style=\"display: inline\">\r\n\t\t\t\t\t\t\t\t<h4>Sté HumanATM</h4>\r\n\t\t\t\t\t\t\t\t<h4>Client : {{inlineInfo.client}}</h4>\r\n\t\t\t\t\t\t\t\t<h6>Date : {{inlineInfo.created_at}}</h6>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t</v-row>\r\n\t\t\t\t</v-card-title>\r\n\t\t\t\t<v-card-text>\r\n\t\t\t\t\t<v-simple-table>\r\n\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<th class=\"text-left\">\r\n\t\t\t\t\t\t\t\t\tTitle\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th class=\"text-left\">\r\n\t\t\t\t\t\t\t\t\tP.U\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th class=\"text-left\">\r\n\t\t\t\t\t\t\t\t\tQté\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th class=\"text-left\">\r\n\t\t\t\t\t\t\t\t\tPt\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr v-for=\"(item, index) in listInvoicesPrint\">\r\n\t\t\t\t\t\t\t\t<td>{{ item.title }}</td>\r\n\t\t\t\t\t\t\t\t<td>{{ item.pu_sale }}</td>\r\n\t\t\t\t\t\t\t\t<td>{{ item.amount_sale }}</td>\r\n\t\t\t\t\t\t\t\t<td>{{ Number(item.pt).toFixed(3) }}</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</v-simple-table>\r\n\t\t\t\t\t<div style=\"display: inline; text-align: right; margin-right:10px ; \">\r\n\t\t\t\t\t\t<h6 style=\"margin-top: 10px;\">Total Brut: {{Number(computeTotalPriceTopay()).toFixed(3)}}$</h6>\r\n\t\t\t\t\t\t<h6>Réduction : {{inlineInfo.decrease}}$</h6>\r\n\t\t\t\t\t\t<h6>Prix total à payer : {{Number(computeTotalPriceTopay() - inlineInfo.decrease).toFixed(3)}}$\r\n\t\t\t\t\t\t</h6>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</v-card-text>\r\n\t\t\t</div>\r\n\t\t\t<v-btn class=\"mt-10\" @click=\"printMethode()\">imprimer</v-btn>\r\n\t\t\t<v-btn class=\"ml-10 mt-10\" @click=\"printLinePermit = !printLinePermit\">Annuler</v-btn>\r\n\t\t</v-card>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport html2pdf from \"html2pdf.js\";\r\n\r\nexport default {\r\n\tname: \"resultInvoice\",\r\n\tcomponents: {\r\n\r\n\t},\r\n\tdata: () => ({\r\n\t\tlistInvoices: [],\r\n\t\turlImage: \"../assets/atmlogo.jpg\",\r\n\t\tlistInlines: [],\r\n\t\tprintLinePermit: false,\r\n\t\tprintinline: [],\r\n\t\tlistInvoicesPrint: [],\r\n\t\tinlineInfo: [],\r\n\t\theader_lineinvoices: [\r\n\t\t\t{\r\n\t\t\t\ttext: 'idOp',\r\n\t\t\t\talign: 'start',\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tvalue: 'id_line',\r\n\t\t\t},\r\n\t\t\t{ text: 'Client', value: 'client' },\r\n\t\t\t{ text: 'Date', value: 'created_at' },\r\n\t\t\t{ text: 'Prix Total ', value: 'totalprice' },\r\n\t\t\t{ text: 'Reduction Accordée', value: 'decrease' },\r\n\t\t\t{ text: 'Net à payer', value: 'net_total_price' },\r\n\t\t\t{ text: 'actions', value: 'actions' },\r\n\t\t],\r\n\r\n\t}),\r\n\tmethods: {\r\n\t\tcomputeTotalPriceTopay() {\r\n\t\t\tvar r = 0;\r\n\t\t\tthis.listInvoicesPrint.forEach(element => {\r\n\t\t\t\tr += element.pt\r\n\t\t\t});\r\n\t\t\treturn r;\r\n\t\t},\r\n\t\tasync printInvoiceInline(idlineinvoice) {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post('lineInvoice/getInvoiceInfo/' + idlineinvoice.id_line)\r\n\t\t\t\tthis.listInvoicesPrint = response.data\r\n\t\t\t\tthis.printinlineinfo(idlineinvoice.id_line)\r\n\t\t\t\tthis.printLinePermit = !this.printLinePermit\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync printinlineinfo(id_line) {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post('lineInvoice/getInlineInfo/' + id_line)\r\n\t\t\t\tthis.inlineInfo = response.data\r\n\t\t\t\tconsole.log(this.inlineInfo)\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync printMethode() {\r\n\r\n\t\t\thtml2pdf(document.getElementById(\"element-to-convert\"), {\r\n\t\t\t\tmargin: 5,\r\n\t\t\t\tfilename: \"facture -\" + this.inlineInfo.client + \"-\" + this.inlineInfo.created_at,\r\n\t\t\t\tjsPDF: {\r\n\t\t\t\t\tformat: 'a6',\r\n\t\t\t\t\torientation: 'portrait'\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync deleteInvoiceInline(idlineinvoice) {\r\n\t\t\tif (confirm(\"Voulez-vous supprimer cette facture de l'operation \" + idlineinvoice.id_line + \" ?\")) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await axios.post('lineInvoice/deleteInvoice/' + idlineinvoice.id_line)\r\n\t\t\t\t\tthis.listInvoices = response.data\r\n\t\t\t\t\tthis.get_listInlines()\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tasync get_listInvoices() {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post('invoice/')\r\n\t\t\t\tthis.listInvoices = response.data\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync get_listInlines() {\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await axios.post('lineInvoice/')\r\n\t\t\t\tthis.listInlines = response.data\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tcreated() {\r\n\t\tthis.get_listInvoices()\r\n\t\tthis.get_listInlines()\r\n\t}\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n#element-to-convert {\r\n\tbackground-image: url('@/assets/atmlogo.jpg');  \r\n\tbackground-size: 300px 300px ; \r\n\tbackground-color: rgb(238, 247, 238);\r\n}\r\n</style>\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}