{"ast":null,"code":"import alert from '@/components/alert.vue';\nimport axiosClient from '@/axios/axios';\nconst axios = axiosClient;\nexport default {\n  name: 'Login',\n  passwordEnable: true,\n  components: {\n    alert\n  },\n\n  data() {\n    return {\n      password: '',\n      username: '',\n      msgAlert: null,\n      classAlert: '',\n      activePassWord: false,\n      logo: ''\n    };\n  },\n\n  props: {\n    source: String\n  },\n  methods: {\n    async handleSubmit() {\n      this.msgAlert = '';\n\n      if (this.password == '' || this.username == '') {\n        this.msgAlert = \"Veuillez d'abord remplir tous  les champs\";\n        this.classAlert = \"info\";\n        return;\n      }\n\n      try {\n        const FormData = new FormData();\n        FormData.append('client_id', this.username);\n        FormData.append('username', this.username);\n        FormData.append('client_secret', this.password);\n        FormData.append('password', this.password);\n        FormData.append('grant_type', 'password');\n        const response = await axios.post('user/login', FormData);\n        console.log(response.data);\n\n        if (response.data['access_token']) {\n          localStorage.setItem('token', response.data['access_token']);\n          localStorage.setItem('username', this.username);\n\n          if (response.data['scope'] === \"admin\") {\n            this.$router.push('/admin');\n          }\n\n          if (response.data['scope'] === \"recept\") {\n            this.$router.push('/welcome');\n          }\n\n          if (response.data['scope'] === \"agent\") {\n            this.$router.push('/welcome');\n          }\n\n          if (response.data['scope'] === \"decl\") {\n            this.$router.push('/welcome');\n          }\n        } else {\n          this.msgAlert = \"Mot de passe ou email incorrect\";\n          this.classAlert = \"danger\";\n        }\n      } catch (e) {\n        this.msgAlert = \"Mot de passe ou email incorrect\";\n        this.classAlert = \"danger\";\n      }\n    },\n\n    method_activePassWord() {\n      if (this.activePassWord == '') {\n        this.logo = 'lock';\n      } else {\n        this.logo = 'eye';\n      }\n\n      return this.activePassWord;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAyCA;AACA;AACA;AAEA;EACAA,aADA;EAEAC,oBAFA;EAGAC;IACAC;EADA,CAHA;;EAMAC;IACA;MACAC,YADA;MAEAC,YAFA;MAGAC,cAHA;MAIAC,cAJA;MAKAC,qBALA;MAMAC;IANA;EAQA,CAfA;;EAgBAC;IACAC;EADA,CAhBA;EAmBAC;IACA;MACA;;MACA;QACA;QACA;QACA;MACA;;MACA;QACA;QACAC;QACAA;QACAA;QACAA;QACAA;QACA;QACAC;;QACA;UACAC;UACAA;;UAEA;YACA;UACA;;UACA;YACA;UACA;;UACA;YACA;UACA;;UACA;YACA;UACA;QAEA,CAjBA,MAiBA;UACA;UACA;QACA;MACA,CA9BA,CA8BA;QACA;QACA;MACA;IACA,CA1CA;;IA2CAC;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;;MACA;IACA;;EAlDA;AAnBA","names":["name","passwordEnable","components","alert","data","password","username","msgAlert","classAlert","activePassWord","logo","props","source","methods","FormData","console","localStorage","method_activePassWord"],"sourceRoot":"src/views/Authentification","sources":["login.vue"],"sourcesContent":["<template>\r\n\t<v-app id=\"inspire\">\r\n\t\t<v-container fluid fill-height>\r\n\t\t\t<v-layout align-center justify-center fill-height class=\"ContainLogin\">\r\n\r\n\t\t\t\t<v-flex xs10 sm8 md6>\r\n\t\t\t\t\t<v-card class=\"elevation-12\">\r\n\t\t\t\t\t\t<v-toolbar dark color=\"primary\">\r\n\t\t\t\t\t\t\t<v-toolbar-title align-center justify-center>BagiraActo</v-toolbar-title>\r\n\t\t\t\t\t\t</v-toolbar>\r\n\t\t\t\t\t\t<v-card-text>\r\n\t\t\t\t\t\t\t<v-form @submit.prevent=\"handleSubmit\">\r\n\t\t\t\t\t\t\t\t<div class=\"d-flex\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>person</v-icon>\r\n\t\t\t\t\t\t\t\t\t<v-text-field name=\"username\" label=\"Login\" required type=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"username\" v-model=\"username\">\r\n\t\t\t\t\t\t\t\t\t</v-text-field>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"d-flex\">\r\n\t\t\t\t\t\t\t\t\t<v-icon class=\"lockIcon\" @click=\"activePassWord = !activePassWord\">lock</v-icon>\r\n\t\t\t\t\t\t\t\t\t<v-text-field v-if=\"activePassWord\" required name=\"password\" label=\"Password\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\" v-model=\"password\"></v-text-field>\r\n\t\t\t\t\t\t\t\t\t<v-text-field v-else name=\"password\" label=\"Password\" type=\"password\"\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"password\">\r\n\t\t\t\t\t\t\t\t\t</v-text-field>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<alert v-if=\"msgAlert\" :activeClass=\"classAlert\" :msg=\"msgAlert\"></alert>\r\n\t\t\t\t\t\t\t\t<v-card-actions>\r\n\t\t\t\t\t\t\t\t\t<v-spacer></v-spacer>\r\n\t\t\t\t\t\t\t\t\t<v-btn type=\"submit\" color=\"primary\">Login</v-btn>\r\n\t\t\t\t\t\t\t\t</v-card-actions>\r\n\t\t\t\t\t\t\t</v-form>\r\n\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t</v-card>\r\n\t\t\t\t</v-flex>\r\n\t\t\t</v-layout>\r\n\t\t</v-container>\r\n\t</v-app>\r\n</template>\r\n\r\n<script>\r\nimport alert from '@/components/alert.vue'\r\nimport axiosClient from '@/axios/axios'\r\nconst axios = axiosClient\r\n\r\nexport default {\r\n\tname: 'Login',\r\n\tpasswordEnable: true,\r\n\tcomponents: {\r\n\t\talert\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tpassword: '',\r\n\t\t\tusername: '',\r\n\t\t\tmsgAlert: null,\r\n\t\t\tclassAlert: '',\r\n\t\t\tactivePassWord: false,\r\n\t\t\tlogo: ''\r\n\t\t}\r\n\t},\r\n\tprops: {\r\n\t\tsource: String,\r\n\t},\r\n\tmethods: {\r\n\t\tasync handleSubmit() {\r\n\t\t\tthis.msgAlert = ''\r\n\t\t\tif (this.password == '' || this.username == '') {\r\n\t\t\t\tthis.msgAlert = \"Veuillez d'abord remplir tous  les champs\"\r\n\t\t\t\tthis.classAlert = \"info\"\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst FormData = new FormData()\r\n\t\t\t\tFormData.append('client_id', this.username)\r\n\t\t\t\tFormData.append('username', this.username)\r\n\t\t\t\tFormData.append('client_secret', this.password)\r\n\t\t\t\tFormData.append('password', this.password)\r\n\t\t\t\tFormData.append('grant_type', 'password')\r\n\t\t\t\tconst response = await axios.post('user/login', FormData)  \r\n\t\t\t\tconsole.log(response.data);\r\n\t\t\t\tif (response.data['access_token']) {\r\n\t\t\t\t\tlocalStorage.setItem('token', response.data['access_token'])\r\n\t\t\t\t\tlocalStorage.setItem('username', this.username)\r\n\r\n\t\t\t\t\tif (response.data['scope'] === \"admin\") {\r\n\t\t\t\t\t\tthis.$router.push('/admin')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (response.data['scope'] === \"recept\") {\r\n\t\t\t\t\t\tthis.$router.push('/welcome')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (response.data['scope'] === \"agent\") {\r\n\t\t\t\t\t\tthis.$router.push('/welcome')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (response.data['scope'] === \"decl\") {\r\n\t\t\t\t\t\tthis.$router.push('/welcome')\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.msgAlert = \"Mot de passe ou email incorrect\"\r\n\t\t\t\t\tthis.classAlert = \"danger\"\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tthis.msgAlert = \"Mot de passe ou email incorrect\"\r\n\t\t\t\tthis.classAlert = \"danger\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethod_activePassWord() {\r\n\t\t\tif (this.activePassWord == '') {\r\n\t\t\t\tthis.logo = 'lock'\r\n\t\t\t} else {\r\n\t\t\t\tthis.logo = 'eye'\r\n\t\t\t}\r\n\t\t\treturn this.activePassWord\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.lockIcon {\r\n\twidth: 20px;\r\n\tpadding-bottom: 10px;\r\n\tcursor: pointer;\r\n}\r\n\r\n.ContainLogin {\r\n\tbackground: rgb(248, 244, 244);\r\n\r\n}\r\n\r\n\r\n#logoHuman {\r\n\tposition: absolute;\r\n\theight: 120px;\r\n\twidth: 220px;\r\n\tmargin-left: 5rem;\r\n\tmargin-top: 2rem;\r\n\topacity: 0.2;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}